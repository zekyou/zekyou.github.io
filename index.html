<!DOCTYPE HTML>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  
  <title>ZeKyou&#39;s Blog</title>
  <meta name="author" content="ZeKyou">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="ZeKyou&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ZeKyou&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">ZeKyou&#39;s Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article id="post-icon-make" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2020-02-12T08:31:33.156Z"><a href="/2020/02/12/icon-make/">2020-02-12</a></time>
      
      
  
    <h1 class="title"><a href="/2020/02/12/icon-make/">icon_make</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    
</div>

        
        
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-pip-change-rs" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2020-02-11T04:40:51.000Z"><a href="/2020/02/11/pip-change-rs/">2020-02-11</a></time>
      
      
  
    <h1 class="title"><a href="/2020/02/11/pip-change-rs/">pip_change_rs</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    
</div>

        
        
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-gmt" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-12-14T00:56:50.000Z"><a href="/2019/12/14/gmt/">2019-12-14</a></time>
      
      
  
    <h1 class="title"><a href="/2019/12/14/gmt/">gmt</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    
</div>

        
        
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-fortran" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-12-01T08:36:21.000Z"><a href="/2019/12/01/fortran/">2019-12-01</a></time>
      
      
  
    <h1 class="title"><a href="/2019/12/01/fortran/">fortran</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    
</div>

        
        
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-ssh" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-11-29T01:35:00.000Z"><a href="/2019/11/29/ssh/">2019-11-29</a></time>
      
      
  
    <h1 class="title"><a href="/2019/11/29/ssh/">Linux下连接远程电脑并传输文件</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">Linux下使用SSH远程连接超算中心</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">SSH</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">SCP</span></a></li></ol></li></ol>
</div>

        
        <h1><span id="linux下使用ssh远程连接超算中心">Linux下使用SSH远程连接超算中心</span></h1><h2><span id="背景">背景</span></h2><p>有时候计算量比较大，需要使用超算中心的电脑进行计算，或者需要远程连接另一台Linux电脑。如果是在windows下，使用xshell和xftp可以进行连接和文件的交互，那么Linux下如何操作呢，Linux只需要使用一下两个命令即可完成。<br>如果您是Win10的话，可以尝试用WSL。</p>
<h2><span id="ssh">SSH</span></h2><p>远程连接电脑只需输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh username@ipaddress</span><br></pre></td></tr></table></figure>

<p>username就是用户名了，ipaddress就是你远程主机的IP，这里我们认为是超算中心的IP</p>
<p>有一些可选参数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-X : 调用图形界面</span><br><span class="line">-p ： 修改连接到服务器的端口（默认为22）</span><br></pre></td></tr></table></figure>

<p>之后输入username的密码就可以了，第一次登陆系统会给出提示，真实性无法确认，yes就行了</p>
<p>我们尝试连接到武汉大学超算中心</p>
<p><img src="ssh01.png" alt="ssh01"></p>
<p>登录成功了</p>
<h2><span id="scp">SCP</span></h2><p>我们如果在超算进行计算，还需要文件交互。在自己电脑上输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp filedirA username@ipaddress:filedirB</span><br></pre></td></tr></table></figure>

<p>就可以实现把文件A传到超算的目录B</p>
<p>反之要下载超算的文件，只需要交换前后顺序就可以</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-reflectdata" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    <div class="gallery">
  <div class="photoset">
    
      
        <img src="https://static.2heng.xin/wp-content/uploads//2019/02/wallhaven-672007-1-1024x576.png">
      
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-19T11:17:00.000Z"><a href="/2019/10/19/reflectdata/">2019-10-19</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/19/reflectdata/">多次覆盖反射波法模拟数据处理</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">CWPSU模拟反射波数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">前情提要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">加噪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">抽道选排</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">参数分析处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">频谱分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">滤波</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">速度谱</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">常规处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">动校正</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">水平叠加</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">解释处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">偏移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">预告</span></a></li></ol></li></ol>
</div>

        
        <h1><span id="cwpsu模拟反射波数据处理">CWPSU模拟反射波数据处理</span></h1><h2><span id="前情提要">前情提要</span></h2><p>之前我们获得一个dataraw.su的反射波模拟数据，我们还需要对它进行处理，以此来获得地层信息。对此有疑问的可以查看上次博客。<br>这是上次的链接：<br><a href="https://zekyou.github.io/2019/10/18/cwpsureflect/" target="_blank" rel="noopener">我是个链接</a><br>我们说过100道，25次覆盖。我们最初是打了25炮，这样只有4个点满足25次覆盖。4个点不足以反映地下介质的信息。因此：</p>
<p><strong>我们调整nxs=49。保持其他的参数不变，即打了49炮，那么我们有（49-24）×4=100个满足25次覆盖的点了。</strong></p>
<p>另外我们会在最后给出<strong>高度整</strong>合的shell脚本和<strong>刘猛学者</strong>的自动完成CDP覆盖次数的脚本。您可以<a href="#link1">点击</a>前去查看，不过我们还是<strong>建议您看完全文</strong>以便您<strong>修改部分参</strong>数使得让重复率降低，从而避免<strong>不必要的麻烦</strong>。</p>
<h2><span id="预处理">预处理</span></h2><h3><span id="加噪">加噪</span></h3><p>我们用正演生成的数据是不含有噪声的数据，为此需要认为加一个噪声，显得很真实（确信了）</p>
<p>我们键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suaddnoise &lt;dataraw.su sn=70 noise=gauss seed=5 &gt;data.noise</span><br></pre></td></tr></table></figure>

<p>Notes: sn 代表信噪比    noise代表噪声分布，这里选择高斯噪声    seed是随机分布种子（Matlab里应该也有相似的设定）</p>
<p>结果如下：</p>
<p>没加噪声</p>
<p><img src="reflectdata1.png" alt="1571455970878"></p>
<p>添加噪声：</p>
<p><img src="reflectdata2.png" alt="1571456006435"></p>
<p>其实除了显得真实没啥用。。。</p>
<h3><span id="抽道选排">抽道选排</span></h3><p>我们需要将获得的4900道记录以CDP道集的形式展示出来。所以我们可以键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suchw &lt;data.noise key1=cdp key2=gx key3=sx b=1 c=1 d=2 &gt;data.suchw</span><br></pre></td></tr></table></figure>

<p>对于suchw的用法，大家可以参考自带的文档</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudoc suchw</span><br></pre></td></tr></table></figure>

<p>这里限于篇幅不展开了</p>
<p>这样相对于我们的记录又有了一个新的地标CDP，大家可以理解为乘坐高铁等车时地下的好几个颜色的地表，现在我们加了一个叫CDP的地标。</p>
<p>我们希望乘客们按照CDP地标来排序，键入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">susort&lt;data.suchw cdp &gt;data.cdp</span><br></pre></td></tr></table></figure>

<p>我们查看CDP地标，看看那些地标前的人数满足25个</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sugethw&lt;data.cdp cdp</span><br></pre></td></tr></table></figure>
<p>在这里我们安利一波刘猛学者的做法，他将终端打印出来的数据存入文件中，编写一个shell来计算每一个CDP出现的次数，这样子做到了自动化计算满足25次覆盖的点。</p>
<p>我们看到在247（其实是247.5）到495这100个地标上有25个人</p>
<p>我们将这些满足的地标单独取出来</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suwind &lt;data.cdp key=cdp min=247 max=495 &gt; data.suc</span><br></pre></td></tr></table></figure>



<p>我们展示247-260间的图像：</p>
<p><img src="reflectdata3.png" alt="1571472026552"></p>
<h2><span id="参数分析处理">参数分析处理</span></h2><h3><span id="频谱分析">频谱分析</span></h3><p>对于频谱分析，我们选取CDP=247的道集作为例子</p>
<p>首先我们单独取出247的记录：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suwind &lt;data.suc key=cdp min=247 max=247 &gt;data247.suc</span><br></pre></td></tr></table></figure>

<p>键入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">susort&lt;data247.suc gx | suxwigb</span><br></pre></td></tr></table></figure>

<p>让25道记录按照检波点的距离以此排开来，作图如下：</p>
<p><img src="reflectdata4.png" alt="1571472512144"></p>
<p>我们用suspecfx进行频谱分析，设定时间域0-0.6s</p>
<p>键入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suwind &lt;data247.suc tmin=0 tmax=0.6 |suspecfx | suxwigb</span><br></pre></td></tr></table></figure>

<p><img src="reflectdata5.png" alt="1571472704464"></p>
<p>可以看到频率大致分为两拨，一波在高频25-40Hz，应该是来自浅表的一层介质，另一波在5-20Hz，应该是深度一些的信息。</p>
<p>我们同样保存一下频率信息，后面可能需要：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suwind &lt;data247.suc tmin=0 tmax=0.6 |suspecfx &gt;data247.fre</span><br></pre></td></tr></table></figure>

<h3><span id="滤波">滤波</span></h3><p>我们采取比较一般的带通滤波，设置4个参数，分别代表梯形的四个拐点</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sufilter &lt;data.suc f=5,10,35,40 amps=0,1,1,0 &gt;data.filter</span><br></pre></td></tr></table></figure>

<p><img src="reflectdata6.png" alt="1571474551310"></p>
<h3><span id="速度谱">速度谱</span></h3><p>原理参见《地震勘探》P211页，这里不展开了。</p>
<p>我们给出suvelan的用法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SUVELAN - compute stacking velocity semblance for cdp gathers</span><br><span class="line"></span><br><span class="line">suvelan &lt;stdin &gt;stdout [optional parameters]</span><br><span class="line"></span><br><span class="line">Optional Parameters:</span><br><span class="line">nv&#x3D;50                   number of velocities</span><br><span class="line">dv&#x3D;50.0                 velocity sampling interval</span><br><span class="line">fv&#x3D;1500.0               first velocity</span><br><span class="line">anis1&#x3D;0.0               quartic term, numerator of an extended quartic term</span><br><span class="line">anis2&#x3D;0.0               in denominator of an extended quartic term</span><br><span class="line">smute&#x3D;1.5               samples with NMO stretch exceeding smute are zeroed</span><br><span class="line">dtratio&#x3D;5               ratio of output to input time sampling intervals</span><br><span class="line">nsmooth&#x3D;dtratio*2+1     length of semblance num and den smoothing window</span><br><span class="line">verbose&#x3D;0               &#x3D;1 for diagnostic print on stderr</span><br><span class="line">pwr&#x3D;1.0                 semblance value to the power</span><br></pre></td></tr></table></figure>

<p>我们需要的参数为nv dv fv分别是速度采样数，间隔，初始值。</p>
<p>因为我们设的地层为1000，1700，2300</p>
<p>所以我们三个参数设为nv=70 dv=20 fv=1000</p>
<p>键入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suvelan &lt;data.filter nv=70 dv=20 fv=1000 &gt;data.velan</span><br></pre></td></tr></table></figure>



<h2><span id="常规处理">常规处理</span></h2><h3><span id="动校正">动校正</span></h3><p>键入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sunmo&lt;data.filter tnmo=0 vnmo=1000 &gt;data.nmo</span><br></pre></td></tr></table></figure>

<p>其中vnmo=你速度谱分析的速度</p>
<h3><span id="水平叠加">水平叠加</span></h3><p>键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">susort&lt;data.nmo |sustack &gt;data.stack key=cdp</span><br></pre></td></tr></table></figure>

<p>你可画图</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suxwigb&lt;data.stack</span><br></pre></td></tr></table></figure>

<p><img src="reflectdata7.png" alt="1571479796375"></p>
<h2><span id="解释处理">解释处理</span></h2><h3><span id="偏移">偏移</span></h3><p>键入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sumigtk&lt;data.stack dxcdp=2.5 vmig=1000 &gt;data.mig</span><br></pre></td></tr></table></figure>

<p>这里dxcdp=你cdp之间的间隔</p>
<p>得到：</p>
<p><img src="reflectdata8.png" alt="1571479771333"></p>
<p>其实变化不大。</p>
<h2><span id="结论"></span></h2><p>我们能够明显的看出有三层介质，但是我们的模型是中间凹的，我们的成像是只有左边凹的，可能有的同学认为我们的错误了，其实不然。</p>
<p>因为我们的CDP起始点恰好位于我们的中心，这就导致了我们的成像只有模型的右边。</p>
<p>如果你想获得一个完全匹配的地层，那么你可以设计CDP道集起始点在模型的起始点。需要设计偏移距为负值，当然这是后话了。</p>
<p>我们在这里给出全部的自动化的脚本，您只需新建一个shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim sum.sh</span><br></pre></td></tr></table></figure>
<p>把下列代码写入，再运行即可。<br>运行一下就可以获得全套数据，不过<strong>强烈建议修改部分参数</strong>使得<strong>重复率</strong>降低！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">constant parameters</span></span><br><span class="line">dt=0.005</span><br><span class="line">nt=101</span><br><span class="line">ft=0.0</span><br><span class="line">kilounits=0</span><br><span class="line"></span><br><span class="line">nxo=100</span><br><span class="line">dxo=5</span><br><span class="line">fxo=5</span><br><span class="line"></span><br><span class="line">nxs=49</span><br><span class="line">dxs=10</span><br><span class="line">fxs=5</span><br><span class="line"><span class="meta">#</span><span class="bash">界面信息ref</span></span><br><span class="line">ref1="0.5:0.0,30;100.0,36;200.0,50;300,50;400,40;500,24"</span><br><span class="line">ref2="0.7:0,60;500,60"</span><br><span class="line">ref3="0.9:0,80;500,80"</span><br><span class="line"><span class="meta">#</span><span class="bash">生成原始文件dataraw.su</span></span><br><span class="line">susynlv &gt; dataraw.su nt=$nt dt=$dt ft=$ft dvdx=0 dvdz=0 nxo=$nxo dxo=$dxo fxo=$fxo nxs=$nxs dxs=$dxs fxs=$fxs ref=$ref1 ref=$ref2 ref=$ref3 v00=1000,1700,2300 kilounits=$kilounits verbose=1</span><br><span class="line"><span class="meta">#</span><span class="bash">添加噪声文件data.noise</span></span><br><span class="line">suaddnoise&lt;dataraw.su sn=70 noise=gauss seed=5 &gt;data.noise</span><br><span class="line"><span class="meta">#</span><span class="bash">添加CDP地标 文件data.suchw</span></span><br><span class="line">suchw&lt;data.noise key1=cdp key2=gx key3=sx b=1 c=1 d=2 &gt;data.suchw</span><br><span class="line"><span class="meta">#</span><span class="bash">按照CDP排序 文件data.cdp</span></span><br><span class="line">susort &lt;data.suchw cdp &gt;data.cdp</span><br><span class="line"><span class="meta">#</span><span class="bash">取出满足25次覆盖的点247-495，如何查看可以依据刘猛学者的shell(后面)</span></span><br><span class="line">suwind &lt;data.cdp key=cdp min=247 max=495 &gt;data.suc</span><br><span class="line"><span class="meta">#</span><span class="bash">单独取出247号做速度分析</span></span><br><span class="line">suwind &lt;data.suc key=cdp min=247 max=247 &gt;data247.suc</span><br><span class="line"><span class="meta">#</span><span class="bash">使247号按gx（检波点近远排列）文件data247.gx</span></span><br><span class="line">susort &lt;data247.suc gx &gt;data247.gx</span><br><span class="line"><span class="meta">#</span><span class="bash">对CDP=247进行频谱分析文件 data247.fre</span></span><br><span class="line">suwind&lt;data247.suc tmin=0 tmax=0.6 | suspecfx &gt;data247.fre</span><br><span class="line"><span class="meta">#</span><span class="bash">滤波 文件data.filter</span></span><br><span class="line">sufilter &lt;data.suc f=5,10,35,40 amps=0,1,1,0 &gt;data.filter</span><br><span class="line"><span class="meta">#</span><span class="bash">获得CDP=247的速度谱文件data247.velan</span></span><br><span class="line">suwind &lt;data.filter key=cdp min=247 max=247 | suvelan verbose=1 fv=800 dv=10 nv=200 pwr=2 &gt;data247.velan</span><br><span class="line"><span class="meta">#</span><span class="bash">动校正文件data.nmo</span></span><br><span class="line">sunmo&lt;data.filter tnmo=0 vnmo=1000 &gt;data.nmo</span><br><span class="line"><span class="meta">#</span><span class="bash">水平叠加文件data.stack</span></span><br><span class="line">susort&lt;data.nmo | sustack &gt;data.stack key=cdp</span><br><span class="line"><span class="meta">#</span><span class="bash">偏移文件data.mig</span></span><br><span class="line">sumigtk&lt;data.stack dxcdp=2.5 vmig=1000 &gt;data.mig</span><br><span class="line"><span class="meta">#</span><span class="bash">您如果需要绘制哪副图只需键入suxwigb&lt;您想绘制的图名字 即可</span></span><br><span class="line"><span class="meta">#</span><span class="bash">例如你想绘制最后的偏移图</span></span><br><span class="line">suxwigb&lt;data.mig</span><br></pre></td></tr></table></figure>
<p>这里再给出刘猛学者的自动拾取满足覆盖要求点数的shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sugethw &lt;data.cdp cdp &gt;cdpsumfile</span><br><span class="line">awk '&#123;a[$0]++&#125;END&#123;for(i in a )&#123;print i,a[i] |"sort -r -k 2"&#125;&#125;' cdpsumfile</span><br></pre></td></tr></table></figure>
<p>用法：<br>在终端执行该命令，即可显示。左边为CDP号，右边为覆盖次数</p>
<h2><span id="预告">预告</span></h2><p>其实在速度谱图中，我们发现存在一些问题，一些参数不太匹配，目前还在处理中，不过无伤大雅，在这里我们向那些没有实践过就完全照抄，甚至误导他人，完全不解释参数，拼接图片的网上方法表示遗憾。因为，我们发现这些错误从08级就开始，我们希望它能够在此被终结！<br>那么关于CWPSU反射的内容就算是全部完结了，感谢猛哥等人给予的关键意见。前前后后好几篇CWPSU的博客，大家都可以参考，不过限于时间和水平，难免纰漏和错误。感谢大家的陪伴，再会！</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-cwpsureflect" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-18T11:35:00.000Z"><a href="/2019/10/18/cwpsureflect/">2019-10-18</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/18/cwpsureflect/">CWPSU用自定义模型产生反射波法模拟数据</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">利用CWPSU自建模型进行反射波法模拟数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">前情提要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">SUSYNLV</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Usage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Main Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Other Parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">产生结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">抽道</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">预告</span></a></li></ol></li></ol>
</div>

        
        <h1><span id="利用cwpsu自建模型进行反射波法模拟数据">利用CWPSU自建模型进行反射波法模拟数据</span></h1><p>拖了很久的反射波法终于出炉了。限于时间，本期只有数据的合成，用法的解释。对于数据后续的处理，放到明天再展开，同学们可以自己先捣鼓。由于有了数据，处理也会如鱼得水。</p>
<h2><span id="前情提要">前情提要</span></h2><p>为什么反射波法拖了这么久，其实还是因为一个矛盾：自建模型和线性数据的矛盾。此话怎讲呢，本人看了很多网上包括前辈们的操作，<strong>大抵相似</strong>，都是使用susynlv来做，不过susynlv是一个模拟线性地层的工具，那不就先前自建的各种崎岖模型就失去意义了吗？对此，网上很多攻略忽略了这一点，有的甚至还<strong>滥竽充数</strong>，分析的头头是道，结果<strong>前后矛盾</strong>。如果说只是单纯的模拟一个在深度和方向上完全线性的地层，那么很简单，直接用susynlv就可以做到，不过显然我们不想这么<strong>咸鱼</strong>。</p>
<p>那么CWPSU提供了susynvxz和susynvxzcs等一系列可以输入模型的方法，这些方法参数众多，琢磨很久也没有完全摸透，索性放弃。不过之前在外网看到一个用trimodel做的模型，再用triseismic做的反射成像，图很漂亮：</p>
<p><img src="cwpsureflect1.png" alt="cwpsureflect1"></p>
<p><img src="cwpsureflect2.png" alt="cwpsureflect2"></p>
<p>奈何不是多次覆盖。难以调用。</p>
<p>我们回到最初的起点，回到<strong>susynlv</strong></p>
<h2><span id="susynlv">SUSYNLV</span></h2><p>我们回到了起点，我们之前一直不想用它是因为所有攻略中它不能带入模型文件，只能做一个线性的地层，或者一个速度为常数的模型，而且那些作者也大多是这么干的。那么susynlv能不能做一个自定义的地层反射波模拟呢？我们先对它的Usage做一个介绍：</p>
<p>不在意原理的同学可以直接到代码块,<a href="#link1">点击跳到Codes</a></p>
<h3><span id="usage">Usage</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"> SUSYNLV - SYNthetic seismograms for Linear Velocity function</span><br><span class="line"></span><br><span class="line"> susynlv &gt;outfile [optional parameters]</span><br><span class="line"></span><br><span class="line"> Optional Parameters:</span><br><span class="line"> nt&#x3D;101                 number of time samples</span><br><span class="line"> dt&#x3D;0.04                time sampling interval (sec)</span><br><span class="line"> ft&#x3D;0.0                 first time (sec)</span><br><span class="line"> kilounits&#x3D;1            input length units are km or kilo-feet</span><br><span class="line">                         &#x3D;0 for m or ft</span><br><span class="line">                        Note: Output (sx,gx,offset) are always m or ft</span><br><span class="line"> nxo&#x3D;1                  number of source-receiver offsets</span><br><span class="line"> dxo&#x3D;0.05               offset sampling interval (kilounits)</span><br><span class="line"> fxo&#x3D;0.0                first offset (kilounits, see notes below)</span><br><span class="line"> xo&#x3D;fxo,fxo+dxo,...     array of offsets (use only for non-uniform offsets)</span><br><span class="line"> nxm&#x3D;101                number of midpoints (see notes below)</span><br><span class="line"> dxm&#x3D;0.05               midpoint sampling interval (kilounits)</span><br><span class="line"> fxm&#x3D;0.0                first midpoint (kilounits)</span><br><span class="line"> nxs&#x3D;101                number of shotpoints (see notes below)</span><br><span class="line"> dxs&#x3D;0.05               shotpoint sampling interval (kilounits)</span><br><span class="line"> fxs&#x3D;0.0                first shotpoint (kilounits)</span><br><span class="line"> x0&#x3D;0.0                 distance x at which v00 is specified</span><br><span class="line"> z0&#x3D;0.0                 depth z at which v00 is specified</span><br><span class="line"> v00&#x3D;2.0                velocity at x0,z0 (kilounits&#x2F;sec)</span><br><span class="line"> dvdx&#x3D;0.0               derivative of velocity with distance x (dv&#x2F;dx)</span><br><span class="line"> dvdz&#x3D;0.0               derivative of velocity with depth z (dv&#x2F;dz)</span><br><span class="line"> fpeak&#x3D;0.2&#x2F;dt           peak frequency of symmetric Ricker wavelet (Hz)</span><br><span class="line"> ref&#x3D;&quot;1:1,2;4,2&quot;        reflector(s):  &quot;amplitude:x1,z1;x2,z2;x3,z3;...</span><br><span class="line"> smooth&#x3D;0               &#x3D;1 for smooth (piecewise cubic spline) reflectors</span><br><span class="line"> er&#x3D;0                   &#x3D;1 for exploding reflector amplitudes</span><br><span class="line"> ls&#x3D;0                   &#x3D;1 for line source; default is point source</span><br><span class="line"> ob&#x3D;1                   &#x3D;1 to include obliquity factors</span><br><span class="line"> tmin&#x3D;10.0*dt           minimum time of interest (sec)</span><br><span class="line"> ndpfz&#x3D;5                number of diffractors per Fresnel zone</span><br><span class="line"> verbose&#x3D;0              &#x3D;1 to print some useful information</span><br><span class="line"></span><br><span class="line">Notes:</span><br><span class="line">Offsets are signed - may be positive or negative.  Receiver locations</span><br><span class="line">are computed by adding the signed offset to the source location.</span><br><span class="line"></span><br><span class="line">Specify either midpoint sampling or shotpoint sampling, but not both.</span><br><span class="line">If neither is specified, the default is the midpoint sampling above.</span><br><span class="line"></span><br><span class="line">More than one ref (reflector) may be specified. Do this by putting</span><br><span class="line">additional ref&#x3D; entries on the commandline. When obliquity factors</span><br><span class="line">are included, then only the left side of each reflector (as the x,z</span><br><span class="line">reflector coordinates are traversed) is reflecting.  For example, if x</span><br><span class="line">coordinates increase, then the top side of a reflector is reflecting.</span><br><span class="line">Note that reflectors are encoded as quoted strings, with an optional</span><br><span class="line">reflector amplitude: preceding the x,z coordinates of each reflector.</span><br><span class="line">Default amplitude is 1.0 if amplitude: part of the string is omitted.</span><br></pre></td></tr></table></figure>

<p>东西很多，不过这里只对我们需要了解的东西做一个介绍。</p>
<h3><span id="main-parameters">Main Parameters</span></h3><p>我们做反射波法模拟，多次覆盖法。需要重点定义：</p>
<ul>
<li>1 道间距</li>
<li>2 道数</li>
<li>3 偏移距</li>
<li>4 覆盖次数</li>
</ul>
<p>本博客做出如下定义：</p>
<p>紧跟上次模型，长500米，深80米。100道，5米一道，起始道位于5米处。25次覆盖（打25炮），根据公式，每炮移动2个道间距（10米），我们采用零偏。那么这些参数怎么在这里体现呢？</p>
<p>经过实验发现：</p>
<p>nxo代表道数、dxo代表道间距、fxo代表第一个检波点位置（默认模型起始为0米）</p>
<p>我们还需要定义炮点参数。在Notes里我们可以了解到，定义炮点参数只需定义nxm和nxs中的一个系列即可，我们选择nxs系列参数：</p>
<p>nxs代表炮数（覆盖数）dxs代表每炮移动距离 fxs代表起始炮位置</p>
<h3><span id="other-parameters">Other Parameters</span></h3><p>我们还需定义一些其他参数，例如采样频率，单位制，速度分布，界面信息等。</p>
<p>本文定义：</p>
<p>采样频dt=0.01 采样次数301 起始采样0s开始</p>
<p>单位制为mkilounits=0</p>
<p>我们说过，我们想把自己的自定义模型用起来，那么susynlv如何做到？我们发现，它提供了一个v00和ref的参数，这使得我们的想法成为可能。</p>
<p>我们定义速度分布为v00=1000,1700,2300</p>
<p>界面信息ref为</p>
<p>ref1=”0.3:0.0,30;100.0,36;200.0,42;300,47;400,40;500,24”<br>ref2=”0.7:0,60;500,60”<br>ref3=”0.8:0,80;500,80”</p>
<p>第一个为反射系数，后面是界面信息。</p>
<p>其实这就是我们之前建立的Model。你可以前去查看：</p>
<p><a href="https://zekyou.github.io/2019/10/16/suunif2/" target="_blank" rel="noopener">点击前去</a></p>
<p>其实到这里你就发现了，我们的susynlv<strong>是可以做到加载自定义</strong>而非线性模型了，只是我们之前用<strong>unif2建立的文件只是用来显示给别人看的</strong>，在这里我们还需重新设置一次<strong>相同</strong>的参数，同时把线性模型<strong>参数全部设为0</strong>。</p>
<h3><span id="codes"></span></h3><p>我们解释了很多参数，这里给出本文使用的shell脚本dg.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">constant parameters</span></span><br><span class="line">dt=0.01</span><br><span class="line">nt=301</span><br><span class="line">ft=0.0</span><br><span class="line">kilounits=0</span><br><span class="line"></span><br><span class="line">nxo=100</span><br><span class="line">dxo=5</span><br><span class="line">fxo=5</span><br><span class="line"></span><br><span class="line">nxs=25</span><br><span class="line">dxs=10</span><br><span class="line">fxs=5</span><br><span class="line">ref1="0.3:0.0,30;100.0,36;200.0,42;300,47;400,40;500,24"</span><br><span class="line">ref2="0.7:0,60;500,60"</span><br><span class="line">ref3="0.8:0,80;500,80"</span><br><span class="line">susynlv &gt; dataraw.su nt=$nt dt=$dt ft=$ft dvdx=0 dvdz=0 nxo=$nxo dxo=$dxo fxo=$fxo nxs=$nxs dxs=$dxs fxs=$fxs ref=$ref1 ref=$ref2 ref=$ref3 v00=1000,1700,2300 kilounits=$kilounits verbose=1</span><br></pre></td></tr></table></figure>

<p>因为我们不再使用完全线性地层，所以两个梯度全部是0。verbose只是可以显示更多信息，不用在意。<br><strong>在这里我们特别说明一下，这里我们让nxs=25是为了理解多次覆盖的方便，我们将在真正数据处理的过程中将它改为49，这是为了满足覆盖的点多一些</strong> 数据处理的链接在<a href="https://zekyou.github.io/2019/10/19/reflectdata/" target="_blank" rel="noopener">此处</a><br>所以我们的模型可以概括如下：</p>
<p>在这样的一个地层中：</p>
<p><img src="cwpsureflect3.png" alt="1571400551475"></p>
<p>（注：我们为了使得界面更加明显，崎岖，中间凹的很厉害）</p>
<p>我们在上面布设了100个检波点，5米一个，起始位置5米处。25次覆盖，每次移动2个道间距（10米）。零偏。文件储存在dataraw.su中。</p>
<h2><span id="产生结果">产生结果</span></h2><h3><span id="运行">运行</span></h3><p>我们运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh ./dg.sh</span><br></pre></td></tr></table></figure>

<p>注意此时不要直接用suxwigb打开，因为它是2500个道集，打开就全是黑的，且道数增倍：</p>
<p><img src="cwpsureflect4.png" alt="1571401128981"></p>
<h3><span id="抽道">抽道</span></h3><p>我们需要抽出我们想要的道数，为了说明一般性，我们抽1和25炮的记录：</p>
<p>输入命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suwind &lt;dataraw.su key=fldr max=1 max=1 |suxwigb &amp;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suwind &lt;dataraw.su key=fldr min=25 max=25 |suxwigb &amp;</span><br></pre></td></tr></table></figure>

<p>分别获得第1炮和第25炮的数据记录：</p>
<p>第1炮：</p>
<p><img src="cwpsureflect5.png" alt="1571401456015"></p>
<p>第25炮：</p>
<p><img src="cwpsureflect6.png" alt="1571401426460"></p>
<p>我们还是能看出区别的。</p>
<p><strong>不过我们需要特别说明：</strong></p>
<p>在第n炮的记录中，第一道并不是我们原先布设的第一道，可以理解，因为我们炮点移动了，比如第2炮的第一道就相对于第一炮的第3道了。也就是说我们的100道是往后顺延的。</p>
<p>这也是<strong>为什么我们后面处理需要抽道选排</strong>了。</p>
<p>后续的数据处理我们还需要加噪声，动校正等等，这个后续会更新，其实只要数据模拟出来了，后面的处理大同小异，相信大家能够完成，当然你也可以期待近期更新（预计19号） 已更新，这是<a href="https://zekyou.github.io/2019/10/19/reflectdata/" target="_blank" rel="noopener">链接</a></p>
<h2><span id="预告">预告</span></h2><p>下期我们将带来模拟数据的处理，噪声、选排、校正、偏移等。再会！</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-cwpsurefraction" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-17T02:05:00.000Z"><a href="/2019/10/17/cwpsurefraction/">2019-10-17</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/17/cwpsurefraction/">CWPSU折射波法实现及SG2格式转化</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">利用CWPSU绘制折射波法曲线</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">前情提要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">SG2格式转换SGY</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">原生Linux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">WSL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Seg2fix</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">绘图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">增益</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">高斯增益</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">初至拾取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">预告</span></a></li></ol></li></ol>
</div>

        
        <h1><span id="利用cwpsu绘制折射波法曲线">利用CWPSU绘制折射波法曲线</span></h1><p>本来这期是反射波的，但是反射波模拟需要点时间，这里先把折射波法的操作给大家过一遍。<br>网上有一些教程，不过基本缺失很多问题解决方案，或者压根就是不可行的，有些人用Matlab直接读取SG2，不过在之后的初至拾取很比较费事，而且用Matlab读取也不简单，一些小问题总是会出现，本博客给出了在CWPSU下的全程攻略，同时提供文件和程序，助您成功！</p>
<p>那么我们主要是遇到两个问题：</p>
<ul>
<li><p>1 如何将sg2文件转化为sgy</p>
</li>
<li><p>2 如何最佳增益图像</p>
</li>
</ul>
<p>本期所用到的数据和程序在Github上给出</p>
<p><a href="https://github.com/zekyou/CWPSURefraction" target="_blank" rel="noopener">这是个链接</a></p>
<p>您可以前去下载，不过数据为本组所测，您可以根据需要增加噪声，以免给您带来不必要的困扰。</p>
<h2><span id="前情提要">前情提要</span></h2><p>前面我们安装好了CWPSU，并先实现了一个简单的Model，但是如何将测量的数据用于实践，我们还没有起步，本期就最简单的折射波法进行解析。</p>
<p>我们采用的是相遇追逐的观测系统。偏移距分别是零偏和8米</p>
<h2><span id="sg2格式转换sgy">SG2格式转换SGY</span></h2><h3><span id="原生linux">原生Linux</span></h3><p>我们野外的仪器采集的数据是SG2格式，但这种格式无法被CWPSU直接读取，CWPSU官网给出了转化插件程序，在src/Third_Part/seg2segy/中。我们在该目录下编译</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make remake</span><br></pre></td></tr></table></figure>

<p>之后再键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./seg2segy filename.sg2 1</span><br></pre></td></tr></table></figure>

<p>即可在该目录下获得第一炮的sgy文件filename.sgy</p>
<p>由于博主没有在原生的Linux下进行该步骤，不确保该步骤的可行性，大家可以反馈给我，如果您没有通过该方法成功转化格式，请看下列步骤</p>
<h3><span id="wsl">WSL</span></h3><p>博主在WSL里编译了seg2segy程序，不过格式转化一直不成功。无奈只好键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc seg2segy</span><br></pre></td></tr></table></figure>

<p>获得a.out</p>
<p>键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./a.out filename.sg2 1</span><br></pre></td></tr></table></figure>

<p>如果还不能解决问题。可以将目录中的C文件换到Windows下编译生成exe（反正WSL最大的优势就是Windows和Linux的快速畅通）</p>
<p>将该exe拷到sg2文件目录下，打开Powershell键入</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./seg2segy.exe filename.sg2 <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>博主在这里直接给出编译好的exe，在上述链接中可以获得。</p>
<h3><span id="seg2fix">Seg2fix</span></h3><p>官方还给出了一个修复sg2文件的程序，如果您的sg2文件是有损的，或是无法被该程序识别的，您可以使用它，您可以在同样的目录下键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o seg2fix.c seg2fix</span><br></pre></td></tr></table></figure>

<p>来获得可执行程序。再键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./seg2fix filename.sg2</span><br></pre></td></tr></table></figure>

<p>同样，如果您无法使用该方法，上述链接也给出了seg2fix.exe。用法与seg2segy相同。</p>
<h2><span id="绘图">绘图</span></h2><h3><span id="增益">增益</span></h3><p>我们获得原始数据会存在后面的检波点振幅过小而无法准确拾取初至。我们需要增益使得图像好看一些。</p>
<p>我们首先绘制原始数据，键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">segyread tape=refract1.sgy endian=0 | suxwigb &amp;</span><br></pre></td></tr></table></figure>

<p>出现原始图像，键入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">segyread tape=refract1.sgy endian=0 | sugain agc=1 |suxwigb &amp;</span><br></pre></td></tr></table></figure>

<p>出现增益图像（此处我们是自动增益模式）。以refreact1为例，我们给出对比</p>
<p>原始图像：</p>
<p><img src="cwpsurefract1.png" alt="1571280592026"></p>
<p>增益图像：</p>
<p><img src="cwpsurefract2.png" alt="1571280637301"></p>
<p>我们看出还是对比很明显的。如果不增益，图像很难看。</p>
<h4><span id="高斯增益">高斯增益</span></h4><p>我们在用同样的方法绘制refract3时发现增益后的图像不是很明显，为此我们需要使用不同的增益方法，博主结果探索，发现高斯增益的图像最漂亮。给出代码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">segyread tape=refract3.sgy endian=0 | sugain gagc=1 |suxwigb &amp;</span><br></pre></td></tr></table></figure>

<p>给出对比</p>
<p>自动增益：</p>
<p><img src="cwpsurefract3.png" alt="1571280815885"></p>
<p>高斯增益：</p>
<p><img src="cwpsurefract4.png" alt="1571280850568"></p>
<p>我们是为了拾取初至，那么我们只关注上方的质量，明显高斯增益要漂亮。</p>
<h3><span id="初至拾取">初至拾取</span></h3><p>在CWPSU中拾取是十分方便的，我们绘制出图形后，在图形中将鼠标放在道上，按下S键，系统就可以将您鼠标所在道数和坐标给到终端中。</p>
<p><img src="cwpsurefract5.png" alt="1571281070613"></p>
<p>为了拾取准确，我们可以放大指定窗口，框住您要放大的地区就可以，效果如下：</p>
<p><img src="cwpsurefract6.png" alt="1571281150677"></p>
<h2><span id="结果">结果</span></h2><p>之后我们就可以将数据复制到excel中，用Matlab或是GMT绘制曲线，效果如下：</p>
<p><img src="cwpsurefract7.png" alt="rfall"></p>
<p><img src="cwpsurefract8.png" alt="rf"></p>
<p>除了一号曲线有些特殊外，其他和教材符合的很好。<br>这应该是一号线拾取的问题，我们重新拾取1、2号线的初至波，同时1号线改用高斯增益更加明显。得到结果如下：<br><img src="cwprefract10.png" alt="rfnew"><br>这个就很漂亮了！</p>
<h2><span id="预告">预告</span></h2><p>那么本期就到这里了，本次的所有数据和程序您都可以在<a href="https://github.com/zekyou/CWPSURefraction" target="_blank" rel="noopener">链接</a>中找到，附有READ说明。</p>
<p>下期我们将继续探讨反射波法的模拟实验，敬请关注！</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-suunif2" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-16T04:07:00.000Z"><a href="/2019/10/16/suunif2/">2019-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/16/suunif2/">CWPSU中自定义地层模型模拟反射波</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">如何在CWPSU中生成自定义地层模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">前情提要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">一些符号说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">UNIF2用法介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">Ximage用法简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">Result</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">预告</span></a></li></ol></li></ol>
</div>

        
        <h1><span id="如何在cwpsu中生成自定义地层模型">如何在CWPSU中生成自定义地层模型</span></h1><h2><span id="前情提要">前情提要</span></h2><p>之前我们安装了CWPSU，需要模拟出反射数据，那么首先需要自定义一个模型，如何定义出一个模型？博主查阅了网上一些资料，不过都是东拼西凑，抄来抄去，从来没有原理性的解释。博主本着大家能够深入了解其原理，真正了解内核，而不是<strong>CTRL+C</strong>完就完事的需求，给大家摘了官方文档，同时做一些讲解和实战。不过限于知识水平，难免疏漏，还请批评指正！</p>
<h2><span id="一些符号说明">一些符号说明</span></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A &lt; B  processA takes input from fileB</span><br><span class="line">A &gt; B  processA wirte on fileB</span><br><span class="line">A &gt;&gt; B processA appends to fileB</span><br><span class="line">A | B  output of A is input to B</span><br><span class="line">A &lt;&lt; B take input from following lines(B represents text)</span><br><span class="line">Tips:'|' is similar to Perl in which represents a pipe</span><br></pre></td></tr></table></figure>



<h2><span id="unif2用法介绍">UNIF2用法介绍</span></h2><p> UNIF2 - generate a 2-D UNIFormly sampled velocity profile from a layered<br>         model. In each layer, velocity is a linear function of position.</p>
<p><strong>格式</strong></p>
<p>  unif2 &lt; infile &gt; outfile [parameters]</p>
<p> <strong>必要参数:</strong><br> none</p>
<p> <strong>可选参数:</strong><br> <strong>ninf</strong>=5  分界面数量<br> <strong>nx</strong>=100 x轴采样个数 (2nd dimension)<br> <strong>nz</strong>=100 z轴采样个数 (1st dimension)<br> <strong>dx</strong>=10          x sampling interval<br> <strong>dz</strong>=10          z sampling interval</p>
<p> npmax=201      maximum number of points on interfaces</p>
<p> fx=0.0 first x sample<br> fz=0.0 first z sample</p>
<p> x0=0.0,0.0,…,        distance x at which v00 is specified<br> z0=0.0,0.0,…,        depth z at which v00 is specified<br> <strong>v00</strong>=1500,2000,2500…, velocity at each x0,z0 (m/sec)</p>
<p> dvdx=0.0,0.0,…,      derivative of velocity with distance x (dv/dx)<br> dvdz=0.0,0.0,…,      derivative of velocity with depth z (dv/dz)</p>
<p> <strong>method</strong>=linear          for linear interpolation of interface<br>                        =mono for monotonic cubic interpolation of interface<br>                        =akima for Akima’s cubic interpolation of interface<br>                        =spline for cubic spline interpolation of interface</p>
<p> tfile=         =testfilename  if set, a sample input dataset is<br>                         output to “testfilename”.</p>
<p>比较重要的，我们本次用得到的我用黑体加粗了。</p>
<p> <strong>说明:</strong><br>关于infile=input file的说明</p>
<p>我们需要定义写入一个model，这个的定义方式类似于Specfem2D，使用过这个软件的同学理解起来应该很简单。</p>
<p>我们的model是由一系列的x，z坐标轴键字对构成的，第一列为x轴，第二列为z轴，分界面之间用1.0    -99999作为符号标记分开。例如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">model</span></span><br><span class="line">0.0   0.0</span><br><span class="line">100.0 0.0</span><br><span class="line">1.0   -99999</span><br><span class="line">0.0   200</span><br><span class="line">100.0 200</span><br><span class="line">1.0   -99999</span><br></pre></td></tr></table></figure>

<p>这个模型就代表了两个界面，他们都是平面。对于第一个界面，起始点坐标0.0，0.0。终点坐标100.0，0.0。我们将这两个点连起来就是界面了，当然它是表面。其他的类似，如果需要起伏界面，只需在内部加入更多的点即可。</p>
<p>method就是控制点之间插值的方式。</p>
<p> <strong>官方示例:</strong><br> unif2 tfile=testfilename    produces a 5 interface demonstration model<br> unif2 &lt; testfilename | psimage n1=100 n2=100 d1=10 d2=10 | …</p>
<h2><span id="ximage用法简介">Ximage用法简介</span></h2><p>我们为了画出模型，还需要Ximage，不过这部分比较简单，直接给出说明</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">Required Parameters:</span><br><span class="line">n1                      number of samples in 1st (fast) dimension</span><br><span class="line"></span><br><span class="line">Optional Parameters:</span><br><span class="line">d1=1.0          sampling interval in 1st dimension</span><br><span class="line">f1=0.0          first sample in 1st dimension</span><br><span class="line">n2=all          number of samples in 2nd (slow) dimension</span><br><span class="line">d2=1.0          sampling interval in 2nd dimension</span><br><span class="line">f2=0.0          first sample in 2nd dimension</span><br><span class="line">mpicks=/dev/tty         file to save mouse picks in</span><br><span class="line">perc=100.0              percentile used to determine clip</span><br><span class="line">clip=(perc percentile) clip used to determine bclip and wclip</span><br><span class="line">bperc=perc              percentile for determining black clip value</span><br><span class="line">wperc=100.0-perc        percentile for determining white clip value</span><br><span class="line">bclip=clip              data values outside of [bclip,wclip] are clipped</span><br><span class="line">wclip=-clip             data values outside of [bclip,wclip] are clipped</span><br><span class="line">balance=0               bclip &amp; wclip individually</span><br><span class="line">                        =1 set them to the same abs value</span><br><span class="line">                          if specified via perc (avoids colorbar skew)</span><br><span class="line">cmap=hsv\'n\' or rgb\'m\'      \'n\' is a number from 0 to 13</span><br><span class="line">                               \'m\' is a number from 0 to 11</span><br><span class="line">                               cmap=rgb0 is equal to cmap=gray</span><br><span class="line">                               cmap=hsv1 is equal to cmap=hue</span><br><span class="line">                               (compatibility to older versions)</span><br><span class="line">legend=0               =1 display the color scale</span><br><span class="line">units=         unit label for legend</span><br><span class="line">legendfont=times_roman10    font name for title</span><br><span class="line">verbose=1              =1 for info printed on stderr (0 for no info)</span><br><span class="line">xbox=50                x in pixels of upper left corner of window</span><br><span class="line">ybox=50                y in pixels of upper left corner of window</span><br><span class="line">wbox=550               width in pixels of window</span><br><span class="line">hbox=700               height in pixels of window</span><br><span class="line">lwidth=16              colorscale (legend) width in pixels</span><br><span class="line">lheight=hbox/3 colorscale (legend) height in pixels</span><br><span class="line">lx=3                   colorscale (legend) x-position in pixels</span><br><span class="line">ly=(hbox-lheight)/3   colorscale (legend) y-position in pixels</span><br><span class="line">x1beg=x1min            value at which axis 1 begins</span><br><span class="line">x1end=x1max            value at which axis 1 ends</span><br><span class="line">d1num=0.0              numbered tic interval on axis 1 (0.0 for automatic)</span><br><span class="line">f1num=x1min            first numbered tic on axis 1 (used if d1num not 0.0)</span><br><span class="line">n1tic=1                number of tics per numbered tic on axis 1</span><br><span class="line">grid1=none             grid lines on axis 1 - none, dot, dash, or solid</span><br><span class="line">label1=                label on axis 1</span><br><span class="line">x2beg=x2min            value at which axis 2 begins</span><br><span class="line">x2end=x2max            value at which axis 2 ends</span><br><span class="line">d2num=0.0              numbered tic interval on axis 2 (0.0 for automatic)</span><br><span class="line">f2num=x2min            first numbered tic on axis 2 (used if d2num not 0.0)</span><br><span class="line">n2tic=1                number of tics per numbered tic on axis 2</span><br><span class="line">grid2=none             grid lines on axis 2 - none, dot, dash, or solid</span><br><span class="line">label2=                label on axis 2</span><br><span class="line">labelfont=Erg14        font name for axes labels</span><br><span class="line">title=         title of plot</span><br><span class="line">titlefont=Rom22        font name for title</span><br><span class="line">windowtitle=ximage     title on window</span><br><span class="line">labelcolor=blue        color for axes labels</span><br><span class="line">titlecolor=red color for title</span><br><span class="line">gridcolor=blue color for grid lines</span><br><span class="line">style=seismic          normal (axis 1 horizontal, axis 2 vertical) or</span><br><span class="line">                       seismic (axis 1 vertical, axis 2 horizontal)</span><br><span class="line">blank=0                This indicates what portion of the lower range</span><br><span class="line">                       to blank out (make the background color).  The</span><br><span class="line">                       value should range from 0 to 1.</span><br><span class="line">plotfile=plotfile.ps  filename for interactive ploting (P)</span><br><span class="line">curve=curve1,curve2,...  file(s) containing points to draw curve(s)</span><br><span class="line">npair=n1,n2,n2,...            number(s) of pairs in each file</span><br><span class="line">curvecolor=color1,color2,...  color(s) for curve(s)</span><br><span class="line">blockinterp=0       whether to use block interpolation (0=no, 1=yes)</span><br></pre></td></tr></table></figure>

<p>花里胡哨的一大堆，不过大多是画图的设置，使用过GMT的同学可能会有心得。我们其实需要用的比较少。</p>
<h2><span id="实战">实战</span></h2><h3><span id="model">Model</span></h3><p>我们首先建立一个model</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim model</span><br></pre></td></tr></table></figure>

<p>Input below parameters</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">our surface boundary</span></span><br><span class="line">0.0		0.0</span><br><span class="line">500.0	0.0</span><br><span class="line">1.0		-99999</span><br><span class="line"><span class="meta">#</span><span class="bash">our first boundary</span></span><br><span class="line">0.0		30.0</span><br><span class="line">100.0	36.0</span><br><span class="line">200.0	38.0</span><br><span class="line">300.0	40.0</span><br><span class="line">400.0	30.0</span><br><span class="line">500.0	24.0</span><br><span class="line">1.0		-99999</span><br><span class="line"><span class="meta">#</span><span class="bash">our second boundary</span></span><br><span class="line">0.0		60.0</span><br><span class="line">500.0	60.0</span><br><span class="line">1.0		-99999</span><br><span class="line"><span class="meta">#</span><span class="bash">our last boundary</span></span><br><span class="line">0.0		80.0</span><br><span class="line">500.0	80.0</span><br><span class="line">1.0		-99999</span><br></pre></td></tr></table></figure>

<p><strong>Tips: Please remove the description lines when you copy the codes !</strong></p>
<h3><span id="code">Code</span></h3><p>We establish a model.sh in the same way</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim model.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">some constant parameters</span></span><br><span class="line">WP=600</span><br><span class="line">HP=400</span><br><span class="line">XP=0</span><br><span class="line">YP=0</span><br><span class="line">ninf=3</span><br><span class="line">nx=101</span><br><span class="line">fx=0</span><br><span class="line">dx=5</span><br><span class="line">nz=41</span><br><span class="line">fz=0</span><br><span class="line">dz=2</span><br><span class="line"><span class="meta">#</span><span class="bash">cwpsu code</span></span><br><span class="line">unif2 &lt;model ninf=$ninf nx=$nx nz=$nz dx=$dx dz=$dz v00=1000,2000,3700 | ximage n1=$nz f1=$fz d1=$dz n2=$nx f2=$fx d2=$dx windowtitle="Reflection Synthetic Model" \</span><br><span class="line">label1="Depth(m)" label2="Distance(m)" wbox=$WP hbox=$HP XP=$XP YP=$YP &amp;</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<h3><span id="result">Result</span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh ./model.sh</span><br></pre></td></tr></table></figure>

<p><img src="suunif2.png" alt="1571201945125"></p>
<p>由于是在WSL里进行的，虽然安装了图形界面，不过<strong>Xming</strong>的画质还是很垃圾，各位在原生的Linux里的图应该比我的高清、漂亮多了！</p>
<h2><span id="预告">预告</span></h2><p>那么本期就到这里了，对于完成模型之后如何进行<strong>数据的采集和处理</strong>我们下期再会！</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  <article id="post-wslgui" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-13T09:35:00.000Z"><a href="/2019/10/13/wslgui/">2019-10-13</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/13/wslgui/">WSL安装图形界面及CWPSU的运行</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">前情提要</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">WSL安装图形界面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">WSL配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">Xming配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">检验</span></a></li></ol></li></ol>
</div>

        
        <h1><span id="前情提要">前情提要</span></h1><p>我们之前在WSL上安装CWPSU时，出现报错</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh1: cannot connect to display!</span><br></pre></td></tr></table></figure>

<p>的情况，本期就来解决这个问题。</p>
<p>我们已经安装好了CWPSU所需要的依赖包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install libx11-dev libc6 freeglut3-dev libmotif4 libxt6 x11proto-print-dev libmotif-dev libxi-dev libxmu-dev</span><br></pre></td></tr></table></figure>

<p>我们需要做的，就是给WSL装一个图形界面。</p>
<h1><span id="wsl安装图形界面">WSL安装图形界面</span></h1><p>网上基本有Xming和VNC的教程，有的说VNC会比较快些，不过博主没有用过，不太确定。</p>
<p>Xming比较简单，使用体验目前来讲也比较好，所以本文只对Xming做解释</p>
<h2><span id="安装">安装</span></h2><p>首先到官网安装Xming，给出链接</p>
<p><a href="https://nchc.dl.sourceforge.net/project/xming/Xming/6.9.0.31/Xming-6-9-0-31-setup.exe" target="_blank" rel="noopener">我是个链接</a></p>
<p>下载好后直接安装</p>
<h2><span id="wsl配置">WSL配置</span></h2><p>我们回到主目录，打开.bashrc或者.zshrc</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim .bashrc</span><br></pre></td></tr></table></figure>

<p>我们加入一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> DISPLAY=:0</span><br></pre></td></tr></table></figure>

<p>注意这里数字可以自己选，不过要记住，因为后面要配对</p>
<p>这样我们就配置好了</p>
<h2><span id="xming配置">Xming配置</span></h2><p>我们安装Xming过程中出现Display setting界面</p>
<p><img src="wslgui1.png" alt="10000"></p>
<p>记得这个地方要和之前的一致，我们这里为0</p>
<p>其他的基本就是直接下一步了</p>
<h2><span id="检验">检验</span></h2><p>我们上次在WSL里安装了CWPSU，不过报错</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh1:... cannot connect to display!</span><br></pre></td></tr></table></figure>

<p>我们说这是因为WSL缺少图形界面，现在我们安装了图形界面，那么是时候检验它了。</p>
<p>我们在WSL里输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suplane | suxwigb &amp;</span><br></pre></td></tr></table></figure>

<p>此时Terminal并没有报错，而是显示</p>
<p><img src="wslgui2.png" alt="1570961150420"></p>
<p>同时，在Windows下弹出了Xming窗口，出现了我们想要的图片</p>
<p><img src="wslgui3.png" alt="1570961205407"></p>
<p>好的，到这里我们就成功了，现在就可以愉快的在WSL里使用CWPSU了！是不是很简单呢！</p>
<p>那么好的，本期就到这里了，再会！</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="as_sitesearch" value="yoursite.com">
  </form>
</div>

    
  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/学术/">学术</a><small>6</small></li>
  
    <li><a href="/categories/技术/">技术</a><small>4</small></li>
  
    <li><a href="/categories/网络/">网络</a><small>3</small></li>
  
  </ul>
</div>

    
  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/tags/代理/">代理</a><small>1</small></li>
  
    <li><a href="/tags/地震/">地震</a><small>6</small></li>
  
    <li><a href="/tags/日语/">日语</a><small>1</small></li>
  
    <li><a href="/tags/计算机/">计算机</a><small>1</small></li>
  
    <li><a href="/tags/语法/">语法</a><small>1</small></li>
  
    <li><a href="/tags/超算/">超算</a><small>1</small></li>
  
    <li><a href="/tags/软件/">软件</a><small>8</small></li>
  
  </ul>
</div>


    

 </aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2020 ZeKyou
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

  <!--loveclick --> 
  <script type="text/javascript" src="/js/love.js"></script>
  <!--funny title -->
  <script type="text/javascript" src="/js/FunnyTitle.js"></script>
</body>
</html>
